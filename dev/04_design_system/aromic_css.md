# Design System: Atomic CSS (Tailwind)

**Status:** Active Protocol
**Scope:** `.astro`, `.tsx`, `tailwind.config.mjs`
**Key Systems:** Tailwind CSS, PostCSS

## 1. The Core Philosophy: "Utility-First"

Astrical does not use traditional BEM (Block Element Modifier) CSS. We do not write `.card { ... }` classes in separate files.
We use **Atomic Utility Classes** directly in the markup.

* **Why?** It reduces bundle size (no dead CSS), enforces consistency (using Design Tokens), and allows for faster iteration.
* **The Rule:** "If you can do it with a Tailwind class, DO NOT write custom CSS."

**Agent Directive:**
> *When styling a component, always reach for utility classes first. Only use `<style>` blocks for complex animations or 3rd-party overrides.*

---

## 2. The Configuration (`tailwind.config.mjs`)

Our Tailwind setup is "Token-Aware." It is configured to read the CSS variables generated by our Theme Engine.

### Custom Extensions
We have extended the default Tailwind palette to use our semantic names.

```javascript
// tailwind.config.mjs (Reference)
theme: {
  extend: {
    colors: {
      primary: 'rgb(var(--aw-color-primary) / <alpha-value>)',
      secondary: 'rgb(var(--aw-color-secondary) / <alpha-value>)',
      accent: 'rgb(var(--aw-color-accent) / <alpha-value>)',
      default: 'rgb(var(--aw-color-text-default) / <alpha-value>)',
      muted: 'rgb(var(--aw-color-text-muted) / <alpha-value>)',
    },
    fontFamily: {
      sans: ['var(--aw-font-sans)', ...defaultTheme.fontFamily.sans],
      serif: ['var(--aw-font-serif)', ...defaultTheme.fontFamily.serif],
      heading: ['var(--aw-font-heading)', ...defaultTheme.fontFamily.sans],
    },
  },
}

```

**Implication:**
You can use opacity modifiers on our custom colors:

* `bg-primary/50` (50% opacity primary color)
* `text-muted/80` (80% opacity muted text)

---

## 3. Standard Patterns & Shortcuts

To keep code readable, we follow specific ordering and grouping conventions.

### A. Layout Primitives

| Pattern | Classes | Use Case |
| --- | --- | --- |
| **Center Content** | `flex items-center justify-center` | Icons, Hero text. |
| **Page Wrapper** | `mx-auto max-w-7xl px-4 sm:px-6` | Main content container. |
| **Responsive Grid** | `grid gap-6 row-gap-5 md:grid-cols-2 lg:grid-cols-3` | Feature lists, Blog indexes. |
| **Full Screen** | `min-h-screen flex flex-col` | Landing pages, 404 pages. |

### B. Typography Styles

We use the `prose` plugin (Typography) for rich text, but manual classes for UI elements.

* **Headings:** `font-bold leading-tighter tracking-tighter font-heading`
* **Subtitles:** `text-xl text-muted dark:text-slate-400`
* **Links:** `text-primary hover:text-primary/80 transition duration-200 ease-in-out`

### C. Interactive Elements (Buttons)

We use the `@apply` directive *sparingly* in `src/assets/styles/base.css` to create the `.btn` component class, as buttons are used everywhere.

```html
<button class="btn-primary">Action</button>

<button class="btn-secondary">Cancel</button>

```

---

## 4. The `class:list` Pattern (Astro)

When conditionally applying classes in Astro, use the `class:list` directive (similar to `clsx`).

**Bad:**

```astro
<div class={`p-4 ${isActive ? 'bg-primary' : 'bg-gray-100'}`}>...</div>

```

**Good:**

```astro
<div class:list={[
  "p-4 rounded-lg transition-colors", 
  { 
    "bg-primary text-white": isActive,
    "bg-gray-100 text-gray-900": !isActive
  }
]}>
  ...
</div>

```

---

## 5. Responsive Design Strategy

We design **Mobile-First**.

* Write the mobile styles (base classes) first.
* Add `md:` or `lg:` prefixes for larger screens.

**Example: The Stack-to-Row**

```html
<div class="flex flex-col md:flex-row gap-4">
  <div class="w-full md:w-1/2">Left</div>
  <div class="w-full md:w-1/2">Right</div>
</div>

```

---

## 6. Dark Mode Implementation

As per `04_design_system/tokens.md`, we use CSS variables for colors. This means you rarely need `dark:` prefixes for colors.

**However, specific exceptions apply:**

1. **Inverting Images:**
```html
<img src="logo.png" class="dark:invert" />

```


2. **Specific Overrides (Shadows/Borders):**
Shadows often need to be lighter or removed in dark mode.
```html
<div class="shadow-lg dark:shadow-none dark:border dark:border-slate-800">

```


3. **Gradients:**
Gradients usually look bad if simply inverted. Define specific dark gradients.
```html
<div class="bg-gradient-to-r from-blue-500 to-cyan-500 dark:from-blue-900 dark:to-cyan-900">

```



---

## 7. Anti-Patterns (What to Avoid)

| Bad Practice | Why it fails | Correct Approach |
| --- | --- | --- |
| **Arbitrary Values** | `w-[350px]`, `top-[13px]` | Breaks design rhythm. Hard to maintain. |
| **The `@apply` Trap** | Creating `.card { @apply p-4 bg-white ... }` for everything. | Reinvents traditional CSS. Increases CSS file size. |
| **Inline Styles** | `style="margin-top: 10px"` | Cannot be overridden by media queries. |
| **Important!** | `!text-red-500` | Specificity wars. |

---

## 8. Debugging Layouts

If a layout is broken, use the **"Debug Border"** technique.

**The Helper Class:**
Add `outline outline-2 outline-red-500` to an element to see its boundaries immediately.

```html
<div class="grid grid-cols-3 gap-4 outline outline-red-500">
  <div class="outline outline-blue-500">Item 1</div>
  <div class="outline outline-blue-500">Item 2</div>
</div>

```
